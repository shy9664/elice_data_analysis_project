{% extends 'base.html' %}

{% block content %}
<div>
    <table>
        <thead>
        <tr>
            <th>번호</th>
            <th>제목</th>
            <th>작성자</th>
            <th>날짜</th>
        </tr>
        </thead>
        <tbody>
        {% if article_list %}
        {% for article in article_list %}
        <tr>
            <td>{{ loop.index }}</td>
            <td><a href='/article/{{ article.id }}'>{{article.title}}</a></td>
            <td>{{ article.name }}</td>
            <td>{{ article.create_date }}</td>
        </tr>
        {% endfor %}
        {% else %}
        <tr> 
            <td colspan='3'>게시글이 존재하지 않습니다. </td>
        </tr>
        {% endif %}
        </tbody>
    </table>
    <button onclick="register()">게시글 등록</button>
</div>
{% endblock %}
{% block scripts %}
<script>
    function register() {
        let access_token = $.cookie('access_token');
        $.ajax({
            type:"GET",
            url:`/board/create`,
            headers:{
            Authorization: `Bearer ${access_token}`
            },
            success: function(response) {
                if (response.result == "success") {
                    location.href = '/article/create'
                }
            },
            error:function(error){
                alert('로그인 후 이용하세요')
                window.location.reload()
            }
        });
    }
</script>
{% endblock %}